# SwinShogi

SwinShogiは、Swin Transformerを使用した将棋AIシステムです。強化学習と深層学習を組み合わせ、高性能な将棋エンジンを目指しています。

## 主な特徴

- **Swin Transformer**による深層学習モデル
- 交差エントロピー損失による方策学習
- モンテカルロ木探索（MCTS）による思考ルーチン
- JAXによる高速化と最適化
- USI（Universal Shogi Interface）プロトコル対応インターフェース
- 自己対局と外部エンジン対戦による評価システム
- 将棋の完全なルール実装（打ち歩詰め禁止、王手判定、詰み判定、千日手検出など）

## プロジェクト構成

```
SwinShogi/
  - config/       # 設定ファイル
  - data/         # 学習・評価用データ
  - scripts/      # 実行スクリプト
  - src/          # ソースコード
    - core/       # コア機能
    - evaluation/ # 評価システム
    - interface/  # USIインターフェース
    - model/      # Swin Transformerモデル
    - rl/         # 強化学習アルゴリズム
    - shogi/      # 将棋ルール
    - tests/      # テストコード
    - utils/      # ユーティリティ
```

## 実装内容

1. 方策損失関数：交差エントロピー損失を使用し、MCTSから得られた行動確率分布とモデルの予測確率分布間の距離を最小化
2. モデルテスト：SwinShogiModelの初期化、推論、パラメータの保存・読み込みテスト
3. USIインターフェース：将棋エンジン通信プロトコル対応、SFEN形式対応、外部エンジン対戦機能
4. 評価システム：自己対局評価と外部エンジン対戦評価
5. パフォーマンス最適化：JAXのJIT最適化とバッチ処理による推論速度向上
6. 将棋ルール：打ち歩詰め禁止、王手判定、詰み判定、千日手検出などの完全実装 